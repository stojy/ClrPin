<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" mc:Ignorable="d"
                    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
                    xmlns:database="clr-namespace:ClrVpin.Models.Shared.Database"
                    xmlns:importer="clr-namespace:ClrVpin.Importer"
                    xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
                    xmlns:controls="clr-namespace:ClrVpin.Controls">

  <ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Defaults.xaml" />
    <ResourceDictionary Source="\Controls\Styles.xaml" />
    <ResourceDictionary Source="\Controls\Converters.xaml" />
 
  </ResourceDictionary.MergedDictionaries>

  <!-- x:Shared resources must be at the top level resource dictionary -->
  <controls:Triggers x:Key="TextChangedTriggers" x:Shared="False">
    <b:EventTrigger EventName="TextChanged">
      <b:InvokeCommandAction Command="{Binding ChangedCommand}" d:DataContext="{d:DesignInstance Type=database:Game}"/>
    </b:EventTrigger>
  </controls:Triggers>

  <!--table and frontend properties-->
  <DataTemplate DataType="{x:Type database:Game}">
    <StackPanel>
      <StackPanel.Resources>
        <Style x:Key="DatabaseEntryTextBoxStyle" TargetType="TextBox" BasedOn="{StaticResource MaterialDesignFloatingHintTextBox}">
          <Setter Property="Margin" Value="0,10" />
          <Setter Property="HorizontalAlignment" Value="Left" />
          <Setter Property="materialDesign:TextFieldAssist.HasClearButton" Value="True" />
          <Setter Property="FontSize" Value="16" />
          <Setter Property="controls:StylableInteraction.Triggers" Value="{StaticResource TextChangedTriggers}"/>
        </Style>
      </StackPanel.Resources>

      <TextBlock Style="{DynamicResource MaterialDesignHeadline5TextBlock}" Text="Local Database Entry" Margin="0" HorizontalAlignment="Center" />

      <!--table properties-->
      <GroupBox Header="Table Properties" Margin="0,10,0,0">
        <StackPanel Margin="5,0">
          <TextBox MinWidth="400" Margin="0,5,0,10" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                   materialDesign:HintAssist.Hint="Name" materialDesign:HintAssist.HelperText="{Binding TableFileWithExtension}"
                   Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
          </TextBox>

          <WrapPanel Margin="0,0,0,0">
            <!--<ComboBox ItemsSource="{Binding ManufacturersFilterView}"
                            Text="{Binding Path=ManufacturerFilter, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            materialDesign:HintAssist.Hint="Manufacturer"
                            Style="{StaticResource EditComboBoxStyle}"
                            Width="300" Margin="10,0,0,0" />-->
            <TextBox MinWidth="350" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                     materialDesign:HintAssist.Hint="Manufacturer" materialDesign:HintAssist.HelperText="e.g. Stern"
                     Text="{Binding Manufacturer, UpdateSourceTrigger=PropertyChanged}" />

            <TextBox MinWidth="45" Margin="5,10,0,10" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                     materialDesign:HintAssist.Hint="Year" materialDesign:HintAssist.HelperText="e.g. 2022"
                     Text="{Binding Year, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
          </WrapPanel>

          <WrapPanel>
            <TextBox MinWidth="100" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                     materialDesign:HintAssist.Hint="Type" materialDesign:HintAssist.HelperText="e.g. EM, SS"
                     Text="{Binding Type, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <TextBox MinWidth="95" Margin="5,10,0,10" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                     materialDesign:HintAssist.Hint="Player Count"
                     Text="{Binding Players, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <TextBox MinWidth="195" Margin="5,10,0,10" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                     materialDesign:HintAssist.Hint="IPDB Identifier" materialDesign:HintAssist.HelperText="{Binding IpdbUrl}"
                     Text="{Binding IpdbId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
          </WrapPanel>

          <WrapPanel>
            <TextBox MinWidth="170" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                     materialDesign:HintAssist.Hint="ROM" materialDesign:HintAssist.HelperText="e.g. magic.zip"
                     Text="{Binding Rom, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <CheckBox FontSize="16" Margin="10,12,0,0" Style="{StaticResource MaterialDesignCheckBox}"
                      Content="Original (not manufactured)" IsChecked="{Binding IsOriginal, Mode=OneWay}" IsEnabled="False" />
          </WrapPanel>

          <TextBox MinWidth="400" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                   materialDesign:HintAssist.Hint="Theme(s)"
                   Text="{Binding Theme, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
        </StackPanel>
      </GroupBox>

      <!--frontend properties-->
      <GroupBox Header="Frontend Properties" Margin="0,15,0,0">
        <StackPanel Margin="5,0">
          <TextBox MinWidth="400" Margin="0,5,0,10" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                   materialDesign:HintAssist.Hint="Description"
                   Text="{Binding Description, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
          <WrapPanel>
            <TextBox MinWidth="100" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                     materialDesign:HintAssist.Hint="Version"
                     Text="{Binding Version, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <TextBox MinWidth="295" Margin="5,10,0,10" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                     materialDesign:HintAssist.Hint="Author(s)"
                     Text="{Binding Author, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
          </WrapPanel>
          <WrapPanel>
            <TextBox MinWidth="50" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                     materialDesign:HintAssist.Hint="Rating"
                     Text="{Binding Rating, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <TextBox MinWidth="345" Margin="5,10,0,10" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                     materialDesign:HintAssist.Hint="Comment(s)"
                     Text="{Binding Comment, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
          </WrapPanel>
          <WrapPanel>
            <TextBox MinWidth="200" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                     materialDesign:HintAssist.Hint="Date Added"
                     Text="{Binding DateAdded, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <TextBox MinWidth="195" Margin="5,10,0,10" Style="{StaticResource DatabaseEntryTextBoxStyle}"
                     materialDesign:HintAssist.Hint="Date Modified"
                     Text="{Binding DateModified, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
          </WrapPanel>
        </StackPanel>
      </GroupBox>
    </StackPanel>
  </DataTemplate>

  <!-- database item (game) -->
  <DataTemplate DataType="{x:Type importer:DatabaseItem}">
    <!--explicit border with background and padding required because the dialog background is transparent to support the image dialog-->
    <Border BorderThickness="0" Padding="10" Background="{DynamicResource MaterialDesignPaper}" MinWidth="400">
      <StackPanel>

        <ContentControl Content="{Binding Game}" />

        <!--buttons-->
        <WrapPanel HorizontalAlignment="Center" Margin="0,10,0,0">
          <WrapPanel.Resources>
            <Style x:Key="DialogButtonStyle" TargetType="Button" BasedOn="{StaticResource FlatButtonStyle}">
              <Setter Property="Margin" Value="0" />
              <Setter Property="Command" Value="{x:Static materialDesign:DialogHost.CloseDialogCommand}" />
            </Style>
            <Style x:Key="DialogButtonHighlightedStyle" TargetType="Button" BasedOn="{StaticResource FlatHighlightButtonStyle}">
              <Setter Property="Margin" Value="0" />
              <Setter Property="Command" Value="{x:Static materialDesign:DialogHost.CloseDialogCommand}" />
            </Style>
          </WrapPanel.Resources>

          <!--<Button Content="Save" HorizontalAlignment="Center" CommandParameter="True" Style="{StaticResource DialogButtonHighlightedStyle}"
                            ToolTip="Add entry to local database file" />-->
          <Button Content="Insert" Width="100" Style="{StaticResource DialogButtonHighlightedStyle}" CommandParameter="{x:Static importer:DatabaseItemAction.Insert}"
                  Visibility="{Binding IsExisting, Converter={StaticResource BoolToCollapsedConverter}}"
                  ToolTip="Update entry in your local database" />
          <Button Content="Update" Width="100" Style="{StaticResource DialogButtonHighlightedStyle}" CommandParameter="{x:Static importer:DatabaseItemAction.Update}"
                  Visibility="{Binding IsExisting, Converter={StaticResource BoolToVisibilityConverter}}"
                  IsEnabled="{Binding IsChanged}"
                  ToolTip="Update entry in your local database" />
          <Button Content="Cancel" IsCancel="True" Width="100" Style="{StaticResource DialogButtonStyle}" CommandParameter="{x:Static importer:DatabaseItemAction.Cancel}"
                  ToolTip="Exit without updating/inserting an entry in your local database" />
        </WrapPanel>

      </StackPanel>
    </Border>
  </DataTemplate>

</ResourceDictionary>