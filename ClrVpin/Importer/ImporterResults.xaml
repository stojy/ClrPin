<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" mc:Ignorable="d"
                    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                    xmlns:importer="clr-namespace:ClrVpin.Importer"
                    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
                    xmlns:controls="clr-namespace:ClrVpin.Controls"
                    xmlns:converters="clr-namespace:ClrVpin.Converters"
                    xmlns:vps="clr-namespace:ClrVpin.Importer.Vps"
                    xmlns:system="clr-namespace:System;assembly=System.Runtime">

  <ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="\Controls\Styles.xaml" />
    <ResourceDictionary Source="\Controls\Templates.xaml" />
  </ResourceDictionary.MergedDictionaries>

  <converters:ListToStringConverter x:Key="ListToStringConverter" />
  <converters:BoolToStringConverter x:Key="UrlToIconConverter" True="WebCancel" False="WebSync" />
  <converters:NullToVisibilityConverter x:Key="NullToVisibilityConverter" True="Visible" False="Collapsed" />
  <converters:NullToVisibilityConverter x:Key="ReverseNullToVisibilityConverter" True="Collapsed" False="Visible" />

  <Style x:Key="HeaderStyle" TargetType="DataGridColumnHeader" BasedOn="{StaticResource MaterialDesignDataGridColumnHeader}">
    <!--<Setter Property="Background" Value="Gray"/>-->
  </Style>

  <DataTemplate x:Key="UrlDetailTemplate" DataType="vps:UrlDetail">
    <Button Style="{StaticResource MaterialDesignFloatingActionSecondaryDarkButton}" ToolTip="{Binding Url}" IsEnabled="{Binding Broken, Converter={StaticResource InvertBooleanConverter}}">
      <materialDesign:PackIcon Kind="{Binding Broken, Converter={StaticResource UrlToIconConverter}}" Height="40" Width="40" Foreground="{DynamicResource MaterialDesignBody}" />
    </Button>
  </DataTemplate>

  <!-- if valid url then show progress and ultimate image, else show broken image -->
  <DataTemplate x:Key="ImageTemplate" DataType="{x:Type system:String}">
    <Grid Height="300" ToolTip="{Binding}">
      <materialDesign:PackIcon Kind="ImageOffOutline" Width="200" Height="200" HorizontalAlignment="Center" VerticalAlignment="Center"
                               Visibility="{Binding Converter={StaticResource NullToVisibilityConverter}}" />
      <Grid Visibility="{Binding Converter={StaticResource ReverseNullToVisibilityConverter}}">
        <ProgressBar Height="50" Width="50" Style="{StaticResource MaterialDesignCircularProgressBar}" Foreground="{DynamicResource MaterialDesignBody}" Value="0" IsIndeterminate="True" />
        <Image Source="{Binding}" Stretch="UniformToFill" />
      </Grid>
    </Grid>
  </DataTemplate>

  <DataTemplate DataType="{x:Type vps:TableFile}">
    <materialDesign:Card Margin="5,0,0,0" Width="500" UniformCornerRadius="6" ClipContent="True">
      <StackPanel>
        <ContentControl Content="{Binding ImgUrl}" ContentTemplate="{StaticResource ImageTemplate}" />

        <!-- version and urls drawn in the same visual 'row' and using DockPanel to ensure truncation -->
        <DockPanel>
          <ListBox DockPanel.Dock="Right" ItemsSource="{Binding Urls}" ItemTemplate="{StaticResource UrlDetailTemplate}" Margin="0,-40,0,0"
                   materialDesign:ListBoxItemAssist.ShowSelection="False" Style="{StaticResource RightAlignedHorizontalListBoxStyle}" />
          <ContentControl Margin="0,4,0,0" Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Updated" controls:GenericAttached.String2="{Binding UpdatedAt}" />
        </DockPanel>

        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Version" controls:GenericAttached.String2="{Binding Version}" />
        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Comment" controls:GenericAttached.String2="{Binding Comment}" />
        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Features"
                        controls:GenericAttached.String2="{Binding Features, Converter={StaticResource ListToStringConverter}}" />
        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Name" controls:GenericAttached.String2="{Binding Name}"
                        Visibility="{Binding Name, Converter={StaticResource NullableToVisibilityConverter}}" />
        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Authors" />
        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Format" controls:GenericAttached.String2="{Binding TableFormat}" />
        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Themes"
                        controls:GenericAttached.String2="{Binding Themes, Converter={StaticResource ListToStringConverter}}" />
        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Created" controls:GenericAttached.String2="{Binding CreatedAt}" />
      </StackPanel>
    </materialDesign:Card>
  </DataTemplate>

  <DataTemplate DataType="{x:Type vps:ImageFile}">
    <materialDesign:Card Margin="5,0,0,0" Width="500" UniformCornerRadius="6" ClipContent="True">
      <StackPanel>
        <ContentControl Content="{Binding ImgUrl}" ContentTemplate="{StaticResource ImageTemplate}" />

        <!-- version and urls drawn in the same visual 'row' and using DockPanel to ensure truncation -->
        <DockPanel>
          <ListBox DockPanel.Dock="Right" ItemsSource="{Binding Urls}" ItemTemplate="{StaticResource UrlDetailTemplate}" Margin="0,-40,0,0"
                   materialDesign:ListBoxItemAssist.ShowSelection="False" Style="{StaticResource RightAlignedHorizontalListBoxStyle}" />
          <ContentControl Margin="0,4,0,0" Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Updated" controls:GenericAttached.String2="{Binding UpdatedAt}" />
        </DockPanel>

        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Version" controls:GenericAttached.String2="{Binding Version}" />
        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Features"
                        controls:GenericAttached.String2="{Binding Features, Converter={StaticResource ListToStringConverter}}" />
        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Name" controls:GenericAttached.String2="{Binding Name}"
                        Visibility="{Binding Name, Converter={StaticResource NullableToVisibilityConverter}}" />
        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Authors" />
        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Created" controls:GenericAttached.String2="{Binding CreatedAt}" />
      </StackPanel>
    </materialDesign:Card>
  </DataTemplate>

  <DataTemplate DataType="{x:Type vps:File}">
    <materialDesign:Card Margin="5,0,0,0" Width="500" UniformCornerRadius="6" ClipContent="True">
      <StackPanel>
        <Grid Height="300">
          <materialDesign:PackIcon Kind="EmoticonHappyOutline" Width="200" Height="200" HorizontalAlignment="Center" VerticalAlignment="Center"/>
        </Grid>

        <!-- version and urls drawn in the same visual 'row' and using DockPanel to ensure truncation -->
        <DockPanel>
          <ListBox DockPanel.Dock="Right" ItemsSource="{Binding Urls}" ItemTemplate="{StaticResource UrlDetailTemplate}" Margin="0,-40,0,0"
                   materialDesign:ListBoxItemAssist.ShowSelection="False" Style="{StaticResource RightAlignedHorizontalListBoxStyle}" />
          <ContentControl Margin="0,4,0,0" Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Updated" controls:GenericAttached.String2="{Binding UpdatedAt}" />
        </DockPanel>

        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Version" controls:GenericAttached.String2="{Binding Version}" />
        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Name" controls:GenericAttached.String2="{Binding Name}"
                        Visibility="{Binding Name, Converter={StaticResource NullableToVisibilityConverter}}" />
        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Authors" />
        <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Created" controls:GenericAttached.String2="{Binding CreatedAt}" />
      </StackPanel>
    </materialDesign:Card>
  </DataTemplate>

  <DataTemplate x:Key="FilesTemplate">
    <controls:HorizontalWheelScrollViewer>
      <ListBox ItemsSource="{Binding}" materialDesign:ListBoxItemAssist.ShowSelection="False" VerticalContentAlignment="Top"
               ItemContainerStyle="{StaticResource HighlightedListBoxItemStyle}" Style="{StaticResource HorizontalListBoxStyle}" />
    </controls:HorizontalWheelScrollViewer>
  </DataTemplate>

  <DataTemplate x:Key="ImporterResultsTemplate" DataType="{x:Type importer:ImporterResultsViewModel}">
    <!-- dock panel to provide a scrollbar (if required) for the child controls -->
    <DockPanel Margin="5">
      <DockPanel DockPanel.Dock="Left" Width="700">

        <TextBlock DockPanel.Dock="Top" Text="TBD.. filtering options" Margin="0,10" />

        <DataGrid Name="ImporterResults" DockPanel.Dock="Bottom" ItemsSource="{Binding GamesView}" AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="False" SelectionMode="Single"
                  materialDesign:DataGridAssist.CellPadding="15 5 5 8" materialDesign:DataGridAssist.ColumnHeaderPadding="15 5 5 8"
                  CellStyle="{StaticResource NoBorderDataGridCellStyle}"
                  ColumnHeaderStyle="{StaticResource HeaderStyle}" CanUserSortColumns="True" IsReadOnly="True"
                  SelectedItem="{Binding SelectedGame}">
          <DataGrid.Columns>
            <DataGridTextColumn d:DataContext="{d:DesignInstance Type=vps:Game}" Header="#" Binding="{Binding Index}" Width="54" />
            <DataGridTextColumn d:DataContext="{d:DesignInstance Type=vps:Game}" Header="Table" Binding="{Binding Name}" Width="250" />
            <DataGridTextColumn d:DataContext="{d:DesignInstance Type=vps:Game}" Header="Manufacturer" Binding="{Binding Manufacturer}" Width="150" />
            <DataGridTextColumn d:DataContext="{d:DesignInstance Type=vps:Game}" Header="Year" Binding="{Binding Year}" Width="53" />
            <DataGridTextColumn d:DataContext="{d:DesignInstance Type=vps:Game}" Header="Updated" Binding="{Binding UpdatedAt}" Width="165" />
          </DataGrid.Columns>
        </DataGrid>

      </DockPanel>
      <DockPanel DockPanel.Dock="Right" Margin="0">
        <StackPanel>
          <UniformGrid Columns="3">
            <ContentControl Content="{Binding SelectedGame.ImgUrl}" ContentTemplate="{StaticResource ImageTemplate}" />

            <GroupBox Header="Table Info (HW)" Margin="5,0">
              <StackPanel>
                <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Name" controls:GenericAttached.String2="{Binding SelectedGame.Name}" />
                <UniformGrid Columns="2">
                  <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Manufacturer" controls:GenericAttached.String2="{Binding SelectedGame.Manufacturer}" />
                  <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Year" controls:GenericAttached.String2="{Binding SelectedGame.Year}" />
                </UniformGrid>
                <UniformGrid Columns="2">
                  <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Type" controls:GenericAttached.String2="{Binding SelectedGame.Type}" />
                  <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Players" controls:GenericAttached.String2="{Binding SelectedGame.Players}" />
                </UniformGrid>
                <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="MPU" controls:GenericAttached.String2="{Binding SelectedGame.Mpu}" />
                <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Themes"
                                controls:GenericAttached.String2="{Binding SelectedGame.Themes, Converter={StaticResource ListToStringConverter}}" />
                <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="IPDB" controls:GenericAttached.String2="{Binding SelectedGame.IpdbUrl}" />
              </StackPanel>
            </GroupBox>

            <GroupBox Header="Virtualized Info (SW)">
              <StackPanel>
                <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Updated" controls:GenericAttached.String2="{Binding SelectedGame.UpdatedAt}" />
                <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Features"
                                controls:GenericAttached.String2="{Binding SelectedGame.Features, Converter={StaticResource ListToStringConverter}}" />
                <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Designers"
                                controls:GenericAttached.String2="{Binding SelectedGame.Designers, Converter={StaticResource ListToStringConverter}}" />
                <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Created" controls:GenericAttached.String2="{Binding SelectedGame.LastCreatedAt}" />
                <ContentControl Template="{StaticResource KeyValueStringPair}" controls:GenericAttached.String="Broken" controls:GenericAttached.String2="{Binding SelectedGame.Broken}" />
              </StackPanel>
            </GroupBox>
          </UniformGrid>

          <GroupBox Margin="0,10,0,0" Header="Files">
            <TabControl Style="{StaticResource MaterialDesignTabControl}">
              <TabItem Header="Tables">
                <ContentControl Content="{Binding SelectedGame.TableFiles}" IsEnabled="{Binding SelectedGame.TableFiles.Count}" ContentTemplate="{StaticResource FilesTemplate}" />
              </TabItem>

              <TabItem Header="Backglasses" IsEnabled="{Binding SelectedGame.B2SFiles.Length}">
                <ContentControl Content="{Binding SelectedGame.B2SFiles}" ContentTemplate="{StaticResource FilesTemplate}" />
              </TabItem>

              <TabItem Header="Wheels" IsEnabled="{Binding SelectedGame.WheelArtFiles.Length}">
                <ContentControl Content="{Binding SelectedGame.WheelArtFiles}" ContentTemplate="{StaticResource FilesTemplate}" />
              </TabItem>

              <TabItem Header="ROMs" IsEnabled="{Binding SelectedGame.RomFiles.Length}">
                <ContentControl Content="{Binding SelectedGame.RomFiles}" ContentTemplate="{StaticResource FilesTemplate}" />

              </TabItem>
              <TabItem Header="Media Packs" IsEnabled="{Binding SelectedGame.MediaPackFiles.Length}">
                <ContentControl Content="{Binding SelectedGame.MediaPackFiles}" ContentTemplate="{StaticResource FilesTemplate}" />

              </TabItem>
              <TabItem Header="DMDs" IsEnabled="{Binding SelectedGame.AltColorFiles.Length}">
                <ContentControl Content="{Binding SelectedGame.AltColorFiles}" ContentTemplate="{StaticResource FilesTemplate}" />

              </TabItem>
              <TabItem Header="Sounds" IsEnabled="{Binding SelectedGame.SoundFiles.Length}">
                <ContentControl Content="{Binding SelectedGame.SoundFiles}" ContentTemplate="{StaticResource FilesTemplate}" />
              </TabItem>

              <TabItem Header="Toppers" IsEnabled="{Binding SelectedGame.TopperFiles.Length}">
                <ContentControl Content="{Binding SelectedGame.TopperFiles}" ContentTemplate="{StaticResource FilesTemplate}" />
              </TabItem>

              <TabItem Header="PuP Packs" IsEnabled="{Binding SelectedGame.PupPackFiles.Length}">
                <ContentControl Content="{Binding SelectedGame.PupPackFiles}" ContentTemplate="{StaticResource FilesTemplate}" />
              </TabItem>

              <TabItem Header="POVs" IsEnabled="{Binding SelectedGame.PovFiles.Length}">
                <ContentControl Content="{Binding SelectedGame.PovFiles}" ContentTemplate="{StaticResource FilesTemplate}" />
              </TabItem>

              <TabItem Header="Alternate Sounds" IsEnabled="{Binding SelectedGame.AltSoundFiles.Length}">
                <ContentControl Content="{Binding SelectedGame.AltSoundFiles}" ContentTemplate="{StaticResource FilesTemplate}" />
              </TabItem>

              <TabItem Header="Rules" IsEnabled="{Binding SelectedGame.RuleFiles.Length}">
                <ContentControl Content="{Binding SelectedGame.RuleFiles}" ContentTemplate="{StaticResource FilesTemplate}" />
              </TabItem>
            </TabControl>
          </GroupBox>
        </StackPanel>
      </DockPanel>
    </DockPanel>

  </DataTemplate>
</ResourceDictionary>
  